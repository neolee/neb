# Nebuchadnezzar

A project aimed at exploring the true potential of AI agents. It is powered by `pydantic-ai` and use [MAL](https://github.com/neolee/mal.git) to streamline the configuration and integration of applications across various language model services.

## LLM Abstraction Layer (MAL)

For more information, please refer to MAL [README](https://github.com/neolee/mal/blob/main/README.md) file.

## Agents

### RAG (Retrieval-Augmented Generation)

#### RAG Framework

*Under Construction*

> `rag/embeddings/embedder.py` 

A general wrapper of embedding models.

> `rag/store/base.py` `rag/store/pgvector.py` `rag/store/chroma.py`

A general wrapper for vector-based knowledge stores, currently supporting `PostgreSQL` (with `pgvector`) and `Chroma`. Adding support for additional databases is straightforward. 

> `rag/text/pdf_loader.py` `rag/text/chunk.py`

Tools for extracting and segmenting text. For further information, refer to the [technical note](ref/rag-related.md). Currently supporting PDF files and more document formats is coming.

#### RAG Agents

All agents are powered by our RAG Framework.

- `kb_online.py`: A Retrieval-Augmented Generator (RAG) system built using `logfire`'s online documentation, which incorporates online JSON data downloading, parsing, embedding, storing, and a retrieval-augmented agent.
- `kb_local.py`: An RAG system constructed with a collection of local PDF files, utilizing the same framework to provide consistent features and streamlined implementation as the aforementioned agent.

### PydanticAI Samples

The majority of PydanticAI examples are designed for OpenAI models but have been updated to utilize **MAL**, making them agnostic to the specific model provider. This allows you to use these samples across nearly any large language model that supports an OpenAI-compatible API.

#### Dependencies

``` toml
dependencies = [
    "asyncpg>=0.30.0",
    "devtools>=0.12.2",
    "httpx[socks]>=0.28.1",
    "logfire[asyncpg]>=3.7.1",
    "pydantic-ai[logfire]>=0.0.35",
    "rtoml>=0.12.0",
]
```

Additional technical details:

- The `logfire` integration is entirely optional, though highly recommended. To exclude this integration, simply remove the import of the `instrument` module and the call to `instrument.init()`. Additionally, in a few sample files (`rag.py`, `weather.py`), you should also eliminate any references to `logfire`.
- Several samples (`bank_support.py`, `rag.py`, `sql_gen.py`) require a database connection. I utilize my local `postgresql` server and the `asyncpg` library for asynchronous access (in the agent). You can adjust the connection parameters or data source name (DSN) and database name to suit your environment.

For more information on each sample, refer to the *sample list* section below.

#### Sample Agents

- `hello.py`: A basic "Hello World"  agent.
- `stream_hello.py`: An asynchronous version of the "Hello World."
- `roulette_wheel.py`: A roulette wheel simulator that demonstrates tool calling and context management within agents.
- `pydantic_model.py`: Integrates Pydantic data validation into agent functionalities.
- `stream_markdown.py`: Uses `rich` to display streamed Markdown output from an agent.
- `stream_whales.py`: Utilizes `rich` to stream and display Pydantic objects generated by an agent.
- `weather.py`: An agent that calls multiple third-party RESTful APIs for weather information.
- `common_tools.py`: Agent using built-in common tools (`duckduckgo_search` and `tavily_search`).
- `bank_support.py` and `bank_db.py`: A customer support agent demonstrating integration with RDBMS/MIS systems.
- `sql_gen.py`: Demonstrates RDBMS integration through a logging analyzer tool.
- `chat_app.*`: A simple chat application built with FastAPI, storing chat history in a SQLite database.
- `question_graph.py`: Allows asking and evaluating agents through the generation of Mermaid graphs.
